{
  "targets": [
    {
      "target_name": "harvester",
      "cflags!": ["-fno-exceptions", "-Wno-unused-parameter"],
      "cflags_cc!": ["-fno-exceptions", "-Wno-unused-parameter"],
      "cflags": ["-Wall", "-Wextra", "-Wpedantic"],
      "cflags_cc": ["-Wall", "-Wextra", "-Wpedantic"],
      "type" : "shared_library",
      "sources": [
        "nodejs-api/harvester_api.cc",
        "nodejs-api/src/HarvestParamsParser.cpp",   
        "nodejs-api/src/TasksManager.cpp",
        "nodejs-api/src/IAsyncTask.cpp",
        "nodejs-api/src/JSONLogger.cpp",
        "nodejs-api/src/AsyncTask_Format.cpp",		
        "nodejs-api/src/AsyncTask_HarvestData.cpp",
        "nodejs-api/src/AsyncTask_HarvestSOH.cpp",
        "nodejs-api/src/AsyncTask_HarvestTimingSOH.cpp",
        "nodejs-api/src/AsyncTask_HarvestLogs.cpp",
        "nodejs-api/src/AsyncTask_LoadHistory.cpp",
        "nodejs-api/src/AsyncTask_FlushHistory.cpp",
        "nodejs-api/src/AsyncTask_ListDevices.cpp",
        "nodejs-api/src/AsyncTask_GetVolumeInfo.cpp",
        "nodejs-api/src/AsyncTask_GetDigitizerInfo.cpp",
        "nodejs-api/src/AsyncTask_ReadVolume.cpp",
        "nodejs-api/src/ProgressDelegate_Harvest.cpp"
      ],
      
      "msvs_settings": {
        "VCCLCompilerTool": {
          "ExceptionHandling": 1
        }
      },
      "xcode_settings": {
        "GCC_ENABLE_CPP_EXCEPTIONS" : "YES"
      },

      "conditions": [
        ['OS=="win"', {
          "defines": ['__WIN32']
        }],
        ['OS=="linux"', {
          "defines": ['__linux__'],
          "conditions": [
            ['target_arch=="silvermont"', {
                "cflags": ['-march=silvermont', '-mtune=silvermont', '-m64'],
                "ldflags": ['-m64']
              }
            ]
          ]
        }],
        ['OS=="mac"', {
          "defines": ['__APPLE__']
        }]         
      ],
      "dependencies": [
        './LibIO/binding.gyp:libLibIO',
        './PSFLib/binding.gyp:libPSFLibrary',
        './PDBLib/binding.gyp:libPDBLibrary',
        './HarvLib/binding.gyp:libHarvLibrary',
        './third-party/MiniSEED/binding.gyp:libMiniSEED'
      ],
      "include_dirs" : [
        './LibIO/',
        './PSFLib/',
        './PDBLib/',
        './HarvLib/',
        './third-party/MiniSEED/'
      ]
    }
  ]
}
