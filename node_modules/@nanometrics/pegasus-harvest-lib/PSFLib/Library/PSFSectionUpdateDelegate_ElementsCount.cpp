#include "PSFSection.h"
#include "PSFSectionUpdateDelegate_ElementsCount.h"

PSFSectionUpdateDelegate_ElementsCount::PSFSectionUpdateDelegate_ElementsCount(const uint32_t nElementsToFlush, const std::shared_ptr<ILogger>& logger)
  : IPSFSectionUpdateDelegate(logger)
  , m_nElementsToFlush(nElementsToFlush)
  , m_nElementsWrittenSinceFlush(0U)
{
  __DEV_CALLSTACK_FUNC__;
}

bool PSFSectionUpdateDelegate_ElementsCount::shouldUpdate(PSFSection* /*pSection*/, const size_t /*dataWritten*/)
{
  __DEV_CALLSTACK_FUNC__;
  return (++m_nElementsWrittenSinceFlush >= m_nElementsToFlush);
}

void PSFSectionUpdateDelegate_ElementsCount::onSectionUpdated(PSFSection* /*pSection*/)
{
  __DEV_CALLSTACK_FUNC__;
  m_nElementsWrittenSinceFlush = 0U;
}
