#ifndef MaxSequenceEndDichotomiser_h__
#define MaxSequenceEndDichotomiser_h__

#include "../../psflib_defines.h"
#include "IDichotomiser.h"

class PSFVolume;
class PSFSection;

/**
 * Search dichotomiser for search engine to seek the last (highest data element sequenceEndIndex) non-empty section
 */
class MaxSequenceEndDichotomiser : public IDichotomiser
{
public:
  /**
   * MaxSequenceEndDichotomiser constructor
   * @param volume  volume to perform a search on
   * @param logger  logger instance
   */
  MaxSequenceEndDichotomiser(const PSFVolume* volume, const std::shared_ptr<ILogger>& logger);
  /**
   * MaxSequenceEndDichotomiser destructor
   */
  ~MaxSequenceEndDichotomiser();

  virtual bool shrinkRange(size_t from, size_t to, size_t& newFrom, size_t& newTo) const __OVERRIDES__(IDichotometer);

private:
  bool isBigger(const PSFSection* pSection1, const PSFSection* pSection2) const;

private:
  const PSFVolume* m_volume;
  PSFSection* m_fromSection;
  PSFSection* m_toSection;
  PSFSection* m_middleSection;

  // not implemented
  MaxSequenceEndDichotomiser(const MaxSequenceEndDichotomiser&) = delete;
  MaxSequenceEndDichotomiser& operator=(const MaxSequenceEndDichotomiser&) = delete;
};

#endif //MaxSequenceEndDichotomiser_h__
